# CVOCR 增强稳定版 v3.0 中文帮助文档

## 目录

1.  [简介](#1-简介)
2.  [核心功能与技术](#2-核心功能与技术)
3.  [系统要求与环境准备](#3-系统要求与环境准备)
4.  [界面布局概览](#4-界面布局概览)
5.  [快速入门指南](#5-快速入门指南)
6.  [功能详解](#6-功能详解)
    *   [6.1 系统状态区](#61-系统状态区)
    *   [6.2 CVOCR组件配置区](#62-cvocr组件配置区)
    *   [6.3 OCR配置区](#63-ocr配置区)
    *   [6.4 图像操作区](#64-图像操作区)
    *   [6.5 文本识别操作区](#65-文本识别操作区)
    *   [6.6 高级设置区](#66-高级设置区)
    *   [6.7 结果操作区](#67-结果操作区)
    *   [6.8 日志区域](#68-日志区域)
7.  [结果查看与管理](#7-结果查看与管理)
8.  [常见问题解答 (FAQ)](#8-常见问题解答-faq)
9.  [版本信息与作者](#9-版本信息与作者)

---

### 1. 简介

**CVOCR (Context Vision OCR) 增强稳定版 v3.0** 是一款功能强大的桌面端文本识别（OCR）工具。它专为需要高精度、高稳定性的用户设计，无论是处理印刷体文档、扫描件，还是包含复杂布局、低质量图像的文本，都能提供卓越的识别效果。

本程序完全重构并集成了多项前沿的计算机视觉与自然语言处理技术，旨在成为您处理各类图像文本识别任务的终极解决方案。

### 2. 核心功能与技术

本程序整合了多种先进的AI模型，形成了一套完整的“上下文视觉OCR”处理流水线：

*   **FSRCNN (快速超分辨率卷积神经网络)**: 提升低分辨率图像的清晰度，让模糊的文字变得清晰可辨。
*   **高级文本分割器**: 自主研发的高精度文本检测引擎，能从复杂的背景中准确地定位文本行和文字区域，远胜于传统方法。
*   **Tesseract OCR**: 采用业界领先的开源OCR引擎作为基础识别核心，保证了广泛的语言支持和稳定性。
*   **LayoutLMv2**: 微软出品的文档布局分析模型。启用后，程序能理解文档的结构（如标题、段落、表格），从而优化识别顺序和结果。
*   **GPT-Neo**: AI大语言模型。启用后，它能对识别出的文本进行上下文分析，智能地纠正OCR识别错误（如将 "he11o" 纠正为 "hello"），提升最终文本的可读性和准确性。
*   **Transformer OCR**: 一种先进的端到端深度学习识别模型，特别擅长处理手写体、艺术字体或不规则排列的文本。

### 3. 系统要求与环境准备

为了保证程序正常运行，请确保您的系统满足以下要求：

1.  **Python 环境**: 建议使用 Python 3.8 或更高版本。
2.  **核心依赖库**: `opencv-python`, `pytesseract`, `Pillow`, `numpy` 等。
3.  **Tesseract OCR 引擎 (关键)**:
    *   **必须单独安装** Tesseract OCR 引擎（版本5.0以上）。这**不是**一个Python库，而是一个独立的程序。
    *   **Windows**: 可从 [Tesseract at UB Mannheim](https://github.com/UB-Mannheim/tesseract/wiki) 下载安装包。
    *   **macOS**: 可使用 Homebrew 安装: `brew install tesseract tesseract-lang`
    *   **Linux (Ubuntu/Debian)**: `sudo apt install tesseract-ocr`
    *   **语言包**: 确保安装了您需要识别的语言包（如 `chi_sim` 用于简体中文，`eng` 用于英文）。
    *   **路径配置**: 如果安装后程序找不到 Tesseract，您需要在程序的**高级设置**中手动指定 `tesseract.exe` 的路径。
4.  **AI模型依赖 (可选)**:
    *   若要使用 LayoutLMv2、GPT-Neo 等高级功能，需要安装 `torch` (PyTorch) 和 `transformers` 库。
    *   `pip install torch transformers sentencepiece`
    *   **注意**: 首次启用这些功能时，程序会自动从网络下载所需的AI模型，请确保网络连接通畅。

**强烈建议**: 首次运行程序时，点击左侧面板的 **【🔍 系统检查】** 按钮，程序会自动检测您的环境是否完整，并提供修复建议。

### 4. 界面布局概览

程序主界面分为左右两大区域：

*   **左侧控制面板**: 包含所有功能设置和操作按钮。从上到下依次是系统状态、组件配置、OCR配置、图像操作、识别操作、高级设置、结果操作和日志信息。
*   **右侧显示区域**: 通过标签页（Tab）展示不同内容，包括图片预览、详细识别结果、识别报告（纯文本）、历史记录、统计信息和比较分析。

### 5. 快速入门指南

只需几步，即可完成您的第一次文本识别：

1.  **启动与检查**:
    *   启动程序。
    *   点击左侧的 **【🔍 系统检查】** 按钮，确保所有关键依赖（特别是Tesseract）都显示正常。
    *   点击 **【🚀 初始化CVOCR】** 按钮。程序会加载必要的模型和配置。首次初始化可能需要一些时间。
2.  **选择图片**:
    *   点击 **【📁 选择图片】** 按钮，选择一张您想要识别的图片。图片会显示在右侧的“图片预览”区域。
3.  **配置识别选项**:
    *   在 **【OCR配置区】** 选择正确的 **识别语言**。
    *   选择 **引擎精度**（建议初次使用时选择“平衡模式”）。
    *   勾选 **【✨ 启用高级文本分割】** 以获得最佳文本定位效果。
4.  **开始识别**:
    *   点击 **【🚀 开始CVOCR识别】** 按钮。程序底部的状态栏会显示进度。
5.  **查看结果**:
    *   识别完成后，程序会自动切换到“识别结果”标签页，显示每个文本块的详细信息。
    *   您可以在“识别报告”标签页查看和复制完整的纯文本结果。
    *   识别出的文本框会以红色边框叠加显示在“图片预览”的图片上。

### 6. 功能详解

#### 6.1 系统状态区

*   **系统状态标签**: 显示当前CVOCR引擎的状态（如“未初始化”、“就绪”或“失败”）。
*   **🔍 系统检查**: 检查运行环境是否完整，是程序运行的第一步。
*   **🚀 初始化CVOCR**: 加载和准备OCR引擎及AI模型。在进行识别前必须点击此按钮。

#### 6.2 CVOCR组件配置区

在这里，您可以启用或禁用构成CVOCR核心技术的AI模型：

*   **🎯 启用FSRCNN超分辨率增强**: 适用于低质量、模糊的图片。
*   **📄 启用LayoutLMv2布局分析**: 适用于包含表格、多栏等复杂布局的文档。
*   **🧠 启用GPT-Neo上下文分析**: 对识别结果进行AI纠错和润色。
*   **🤖 启用Transformer OCR**: 尝试使用更先进的端到端模型进行识别，对特殊字体可能效果更好。

#### 6.3 OCR配置区

*   **识别语言**: 选择图片中的主要语言。`chi_sim+eng` 适用于中英混合文档。
*   **引擎精度设置**:
    *   **快速模式**: 最快，适用于高质量、简单的文本。
    *   **平衡模式**: 速度和精度的最佳平衡点，推荐默认使用。
    *   **精确模式/超精确模式**: 更慢但更准确，适用于困难的识别任务。
*   **Tesseract 核心参数**:
    *   **结果置信度阈值**: 过滤掉置信度低于此值的识别结果。
    *   **页面分割模式 (PSM)**: Tesseract的内置布局分析模式。**注意**：当启用下方的“高级文本分割”时，此设置基本被取代。
*   **高级文本分割设置**:
    *   **✨ 启用高级文本分割**: **强烈推荐勾选**。使用程序内置的先进算法来定位文本区域，通常比Tesseract自带的PSM模式更精准。
    *   **分割精度**: 可以为文本分割过程单独选择精度等级，以平衡定位速度和准确性。

#### 6.4 图像操作区

*   **📁 选择图片**: 选择单个图片文件进行识别。
*   **🎨 生成测试图片**: 创建一张包含各种文本样式和干扰的图片，用于测试程序功能。
*   **📁 批量选择**: 选择多个图片文件，为批量处理做准备。

#### 6.5 文本识别操作区

*   **🚀 开始CVOCR识别**: 对当前加载的图片，使用当前所有配置进行识别。
*   **⚡ 批量处理**: 对通过“批量选择”加载的所有图片，依次进行识别。
*   **⚡ 快速OCR**: 使用最快的配置（禁用所有高级组件和预处理）对当前图片进行一次快速识别。

#### 6.6 高级设置区

这里包含了大量用于优化识别效果的微调选项。

*   **图像预处理选项**:
    *   **🔧 启用智能预处理**: 总开关。关闭后，所有下方预处理选项都将失效。
    *   **⚡ 强制高强度预处理**: 忽略程序对图像质量的自动评估，强制使用最强的处理手段。适用于您确定图像质量很差的情况。
*   **几何校正**:
    *   **📐 启用倾斜校正**: 自动拉直倾斜的文档。
    *   **🖼️ 移除边框**: 自动切除图片周围的空白或黑色边框。
    *   **✂️ 裁剪到内容**: 更精确地裁剪，只保留有文字或图形的区域。
    *   **📄 页面边框检测**: 适用于扫描或拍摄的书页，能进行透视校正。
*   **图像增强与降噪**:
    *   **🌫️ 阴影移除**: 尝试消除因光照不均产生的阴影。
    *   **高级降噪/双边滤波**: 两种不同的去噪技术，用于去除图片中的噪点。
    *   **直方图均衡化/CLAHE增强**: 增强图像对比度。
    *   **反锐化掩模**: 一种专业的锐化技术，使文字边缘更清晰。
*   **二值化**: 将图像转换为黑白图像的参数，通常保持默认即可。
*   **显示设置**:
    *   **📊 显示置信度**: 在“识别结果”表格中显示每个文本块的置信度百分比。
*   **保存设置**:
    *   **💾 保存识别结果**: 控制是否将识别结果保存到历史记录中。
    *   **📄 自动保存结果**: 每次识别成功后，自动将结果（JSON格式）保存到程序目录下的 `ocr_results` 文件夹。
*   **性能设置**:
    *   **🖥️ 使用GPU加速**: 如果您有NVIDIA显卡并正确安装了CUDA环境，勾选此项可以大幅加速AI模型的计算。

#### 6.7 结果操作区

*   **📊 显示可视化**: 在“图片预览”中重新显示当前结果的红色文本框。
*   **📤 导出结果**: 将当前识别结果导出为 JSON 或 TXT 文件。
*   **🧹 清空结果**: 清除当前显示的结果，但不会删除历史记录。

#### 6.8 日志区域

显示程序运行过程中的所有状态信息、警告和错误。

*   **清除日志**: 清空日志显示区。
*   **保存日志**: 将当前日志内容保存为 `.log` 文件，方便排查问题。

### 7. 结果查看与管理

右侧的标签页是您与识别结果交互的主要区域。

*   **🖼️ 图片预览**: 显示加载的图片。识别完成后，文本框会叠加显示。双击“识别结果”列表中的某一项，会在这里高亮对应的文本框。
*   **📄 识别结果**: 以表格形式详细列出每一个识别出的文本块，包括其内容、置信度、位置坐标等信息。
*   **📝 识别报告**: 提供一个纯文本编辑器，显示拼接好的完整识别结果，方便您直接复制和编辑。
*   **📚 历史记录**: 自动保存每一次的识别任务。您可以双击任意一条记录来重新加载当时的图片和识别结果。
*   **📈 统计信息**: 展示关于您使用情况的统计数据，如总识别次数、平均处理时间、组件使用频率等。

### 8. 常见问题解答 (FAQ)

*   **问：初始化失败或提示找不到Tesseract怎么办？**
    *   **答：** 这是最常见的问题。请确保您已在操作系统中**独立安装**了Tesseract OCR引擎，而不仅仅是`pytesseract`这个Python库。如果已安装但仍失败，请在**高级设置**中点击【浏览】按钮，手动找到并选择 `tesseract.exe` (Windows) 或 `tesseract` (macOS/Linux) 的可执行文件路径。

*   **问：识别速度很慢怎么办？**
    *   **答：** 识别速度主要受AI组件和精度的影响。要提速，可以：
        1.  在**CVOCR组件配置区**中，取消勾选计算量大的模型，如LayoutLMv2和GPT-Neo。
        2.  在**OCR配置区**，将**引擎精度**设置为“快速模式”或“平衡模式”。
        3.  如果您有符合要求的NVIDIA显卡，请在**高级设置**中勾选**使用GPU加速**。

*   **问：识别结果不准确怎么办？**
    *   **答：** 提升准确度可以尝试：
        1.  确保在**OCR配置区**选择了正确的**识别语言**。
        2.  尝试更高的**引擎精度**，如“精确模式”。
        3.  在**高级设置区**调整**图像预处理选项**。例如，对模糊图片启用**FSRCNN**和**反锐化掩模**，对有阴影的图片启用**阴影移除**。
        4.  启用**GPT-Neo上下文分析**，让AI帮助纠正明显的逻辑或拼写错误。

### 9. 版本信息与作者

*   **程序名称**: CVOCR 增强稳定版
*   **当前版本**: 3.0.0 (2025)
*   **作者**: 跳舞的火公子

---
